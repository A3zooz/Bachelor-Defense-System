{"ast":null,"code":"import generateCellNumber from './generateCellNumber.js'; // Supports \"merging cells\" across columns and rows.\n// https://rdrr.io/cran/openxlsx/man/mergeCells.html\n//\n// XML example:\n// `<sheetData>...</sheetData><mergeCells count=\"1\"><mergeCell ref=\"A2:C3\"/></mergeCells>`\n//\n// Configuration example:\n//\n// rows:\n// [\n//   [...],\n//   [\n//     { type: String, value: 'abc', span: 3, rowSpan: 2 },\n//     { ... },\n//     { ... }\n//   ],\n//   [...],\n// ]\n\nexport default function generateMergedCellsDescription(data, _ref) {\n  var schema = _ref.schema;\n\n  if (schema) {\n    return '';\n  }\n\n  var mergedCells = [];\n  var rowIndex = 0;\n\n  while (rowIndex < data.length) {\n    var row = data[rowIndex];\n    var columnIndex = 0;\n\n    while (columnIndex < row.length) {\n      var cell = row[columnIndex];\n\n      if (cell) {\n        var _cell$span = cell.span,\n            span = _cell$span === void 0 ? 1 : _cell$span,\n            _cell$rowSpan = cell.rowSpan,\n            rowSpan = _cell$rowSpan === void 0 ? 1 : _cell$rowSpan;\n\n        if (span > 1 || rowSpan > 1) {\n          // Validate that `span`-ning or `rowSpan`-ning cells only overlap\n          // `null` or `undefined` ones. Especially that `span`-ning or `rowSpan`-ning cells\n          // don't overlap other `span`-ning or `rowSpan`-ning cells.\n          validateSpanningCellsOverlap({\n            data: data,\n            rowIndex: rowIndex,\n            columnIndex: columnIndex,\n            span: span,\n            rowSpan: rowSpan\n          }); // Add \"merged cells\" entry.\n\n          var rowNumber = rowIndex + 1;\n          mergedCells.push(generateCellNumber(columnIndex, rowNumber) + ':' + generateCellNumber(columnIndex + (span ? span - 1 : 0), rowNumber + (rowSpan ? rowSpan - 1 : 0)));\n        }\n      }\n\n      columnIndex++;\n    }\n\n    rowIndex++;\n  }\n\n  if (mergedCells.length === 0) {\n    return '';\n  }\n\n  return \"<mergeCells count=\\\"\".concat(mergedCells.length, \"\\\">\") + mergedCells.map(function (coordinates) {\n    return \"<mergeCell ref=\\\"\".concat(coordinates, \"\\\"/>\");\n  }).join('') + '</mergeCells>';\n} // Validate that a `span`-ning / `rowSpan`-ning cell doesn't overlap\n// with other cells, especially `span`-ning / `rowSpan`-ning ones,\n// because those ones would make MS Office 2007 Excel say:\n// \"Excel found unreadable content in 'file.xlsx'.\n//  Do you want to recover the contents of this workbook?\n//  If you trust the source of this workbook, click Yes\".\n\nfunction validateSpanningCellsOverlap(_ref2) {\n  var data = _ref2.data,\n      rowIndex = _ref2.rowIndex,\n      columnIndex = _ref2.columnIndex,\n      span = _ref2.span,\n      rowSpan = _ref2.rowSpan;\n  var i = rowIndex;\n\n  while (i <= rowIndex + (rowSpan - 1)) {\n    var j = columnIndex;\n\n    while (j <= columnIndex + (span - 1)) {\n      var cell = data[i][j];\n\n      if (i > rowIndex || j > columnIndex) {\n        if (cell !== null && cell !== undefined) {\n          throw new Error(\"[write-excel-file] When using `span` or `rowSpan` parameters, all hidden overlapped cells should be represented by `null`s or `undefined`s. Cell at row \".concat(rowIndex + 1, \" and column \").concat(columnIndex + 1, \" is configured with `span` \").concat(span, \" and `rowSpan` \").concat(rowSpan, \". Cell at row \").concat(i + 1, \" and column \").concat(j + 1, \" is neither `null` nor `undefined`: \").concat(JSON.stringify(cell)));\n        }\n      }\n\n      j++;\n    }\n\n    i++;\n  }\n}","map":{"version":3,"mappings":"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","names":["generateCellNumber","generateMergedCellsDescription","data","schema","mergedCells","rowIndex","length","row","columnIndex","cell","span","rowSpan","validateSpanningCellsOverlap","rowNumber","push","map","coordinates","join","i","j","undefined","Error","JSON","stringify"],"sources":["C:\\Users\\anasn\\Downloads\\Bachelor-Defense-System-5\\my-app\\node_modules\\write-excel-file\\source\\write\\generateMergedCellsDescription.js"],"sourcesContent":["import generateCellNumber from './generateCellNumber.js'\r\n\r\n// Supports \"merging cells\" across columns and rows.\r\n// https://rdrr.io/cran/openxlsx/man/mergeCells.html\r\n//\r\n// XML example:\r\n// `<sheetData>...</sheetData><mergeCells count=\"1\"><mergeCell ref=\"A2:C3\"/></mergeCells>`\r\n//\r\n// Configuration example:\r\n//\r\n// rows:\r\n// [\r\n//   [...],\r\n//   [\r\n//     { type: String, value: 'abc', span: 3, rowSpan: 2 },\r\n//     { ... },\r\n//     { ... }\r\n//   ],\r\n//   [...],\r\n// ]\r\n\r\nexport default function generateMergedCellsDescription(data, { schema }) {\r\n\tif (schema) {\r\n\t\treturn ''\r\n\t}\r\n\r\n\tconst mergedCells = []\r\n\r\n\tlet rowIndex = 0\r\n\twhile (rowIndex < data.length) {\r\n\t\tconst row = data[rowIndex]\r\n\t\tlet columnIndex = 0\r\n\t\twhile (columnIndex < row.length) {\r\n\t\t\tconst cell = row[columnIndex]\r\n\t\t\tif (cell) {\r\n\t\t\t\tconst { span = 1, rowSpan = 1 } = cell\r\n\r\n\t\t\t\tif (span > 1 || rowSpan > 1) {\r\n\t\t\t\t\t// Validate that `span`-ning or `rowSpan`-ning cells only overlap\r\n\t\t\t\t\t// `null` or `undefined` ones. Especially that `span`-ning or `rowSpan`-ning cells\r\n\t\t\t\t\t// don't overlap other `span`-ning or `rowSpan`-ning cells.\r\n\t\t\t\t\tvalidateSpanningCellsOverlap({ data, rowIndex, columnIndex, span, rowSpan })\r\n\r\n\t\t\t\t\t// Add \"merged cells\" entry.\r\n\t\t\t\t\tconst rowNumber = rowIndex + 1\r\n\t\t\t\t\tmergedCells.push(\r\n\t\t\t\t\t\tgenerateCellNumber(columnIndex, rowNumber) +\r\n\t\t\t\t\t\t':' +\r\n\t\t\t\t\t\tgenerateCellNumber(\r\n\t\t\t\t\t\t\tcolumnIndex + (span ? span - 1 : 0),\r\n\t\t\t\t\t\t\trowNumber + (rowSpan ? rowSpan - 1 : 0)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcolumnIndex++\r\n\t\t}\r\n\t\trowIndex++\r\n\t}\r\n\r\n\tif (mergedCells.length === 0) {\r\n\t\treturn ''\r\n\t}\r\n\r\n\treturn `<mergeCells count=\"${mergedCells.length}\">` +\r\n\t\tmergedCells.map(coordinates => `<mergeCell ref=\"${coordinates}\"/>`).join('') +\r\n\t\t'</mergeCells>'\r\n}\r\n\r\n// Validate that a `span`-ning / `rowSpan`-ning cell doesn't overlap\r\n// with other cells, especially `span`-ning / `rowSpan`-ning ones,\r\n// because those ones would make MS Office 2007 Excel say:\r\n// \"Excel found unreadable content in 'file.xlsx'.\r\n//  Do you want to recover the contents of this workbook?\r\n//  If you trust the source of this workbook, click Yes\".\r\nfunction validateSpanningCellsOverlap({ data, rowIndex, columnIndex, span, rowSpan }) {\r\n\tlet i = rowIndex\r\n\twhile (i <= rowIndex + (rowSpan - 1)) {\r\n\t\tlet j = columnIndex\r\n\t\twhile (j <= columnIndex + (span - 1)) {\r\n\t\t\tconst cell = data[i][j]\r\n\t\t\tif (i > rowIndex || j > columnIndex) {\r\n\t\t\t\tif (cell !== null && cell !== undefined) {\r\n\t\t\t\t\tthrow new Error(`[write-excel-file] When using \\`span\\` or \\`rowSpan\\` parameters, all hidden overlapped cells should be represented by \\`null\\`s or \\`undefined\\`s. Cell at row ${rowIndex + 1} and column ${columnIndex + 1} is configured with \\`span\\` ${span} and \\`rowSpan\\` ${rowSpan}. Cell at row ${i + 1} and column ${j + 1} is neither \\`null\\` nor \\`undefined\\`: ${JSON.stringify(cell)}`)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tj++\r\n\t\t}\r\n\t\ti++\r\n\t}\r\n}"]},"metadata":{},"sourceType":"module"}